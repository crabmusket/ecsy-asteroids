<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ecsy-three webgl - geometry - cube</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <link type="text/css" rel="stylesheet" href="./main.css" />
    <script type="javascript">
      // #
      window.process = { env: { NODE_ENV: "development" } };
    </script>
    <script type="module">
      import { Component, System, Types } from 'https://unpkg.com/ecsy@0.4.0?module';
      import { initialize, Object3DComponent } from "https://unpkg.com/ecsy-three@0.1.2?module";
      import {
        AmbientLight,
        Mesh,
        BoxBufferGeometry,
        MeshBasicMaterial,
        TextureLoader,
        Vector3
      } from "https://unpkg.com/three@0.119.1?module";

      class Rotating extends Component {}
      Rotating.schema = {
        speed: { default: 1, type: Types.Number }
      };

      class RotationSystem extends System {
        execute(delta) {
          this.queries.entities.results.forEach(entity => {
            var rotation = entity.getObject3D().rotation;
            rotation.x += 0.5 * delta;
            rotation.y += 0.1 * delta;
          });
        }
      }

      RotationSystem.queries = {
        entities: {
          components: [Rotating, Object3DComponent]
        }
      };

      var world;

      init();

      function init() {
        // Initialize the default sets of entities and systems
        const { world, sceneEntity, camera } = initialize();

        world.registerComponent(Rotating);
  
        world.registerSystem(RotationSystem);
        
        // Modify the position for the default camera
        camera.position.z = 2;

        const mesh = new Mesh(
          new BoxBufferGeometry(),
          new MeshBasicMaterial({
            map: new TextureLoader().load("https://cdn.glitch.com/6ba7eebb-530e-4f8d-ac73-5ca75e7b1468%2Fcrate.gif?v=1593219591626"),
          })
        );

        world
          .createEntity()
          .addComponent(Rotating)
          .addObject3DComponent(mesh, sceneEntity);
        
      }
    </script>
  </head>
  <body></body>
</html>
